---
title: "Draft Research pt1"
author: "Tom Kain"
date: "February 20, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("R/yahoo_api.R")
library(tidyverse)
library(rlist)
```

# Position Eligibility

```{r}
get_json("users;use_login=1/games;game_keys=mlb/players") -> players

players %>%
  content() -> players_content

players_content$fantasy_content$users$`0`$user[[2]]$games$`0`$game[[2]]$players[c(1:25)] -> players_list

# trying different approach from https://cran.r-project.org/web/packages/jsonlite/vignettes/json-aaquickstart.html
players %>%
  content("text") %>%
  fromJSON() -> players_fromJSON

players_fromJSON$fantasy_content$users$`0`$user$games$`0`$game[[2]]$players[1:25] -> players_fromJSON_dataframe


players_fromJSON_dataframe$`0`$player[[2]][[1]]

# data camp approach
players_content$fantasy_content$users$`0`$user[[2]]$games$`0`$game[[2]][[1]] -> players_content_list

players_content_list %>% str(max.level=3)
players_content_list %>% saveRDS("data/players_content_list.Rds")
```
So this is a list of 26 elements, 25 lists, and "count" int = 25. One player is represented in each of the 25 nested lists, but their data is actually three levels of nesting beneath!

Need to figure out how to extract that great-grandchild list from each of the 25 child lists, then I should be able to stack them via rlist.


# Projection Data

Info for getting depth chart projections:
[Batters](https://www.fangraphs.com/projections.aspx?pos=all&stats=bat&type=fangraphsdc&team=0&lg=all&players=0)

[Pitchers](https://www.fangraphs.com/projections.aspx?pos=all&stats=pit&type=fangraphsdc&team=0&lg=all&players=0)

Download to CSV via:
`javascript:__doPostBack('ProjectionBoard1$cmdCSV','')`

Downloading manually for now...

```{r}
pitchers <- read_csv("data/depthChartProjections_pitchers_20190220.csv")

batters <- read_csv("data/depthChartProjections_batters_20190220.csv")

pitchers
batters
```
