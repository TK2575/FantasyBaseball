---
title: "Optimal Lineup"
author: "Tom Kain"
date: "July 6, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
rosters_by_position <- row_per_position(rosters)

rosters_by_position %>% 
  filter(!is.na(manager)) %>% 
  group_by(position) %>% 
  count() %>% 
  ungroup() -> rostered_count_by_pos

rosters_by_position %>% 
  group_by(position) %>% 
  arrange(zar %>% desc()) %>% 
  mutate(num = row_number()) %>% 
  full_join(rostered_count_by_pos, "position") %>% 
  filter(num <= n) %>% 
  summarize(median_zar = median(zar)) -> pos_median_zar

rosters_by_position %>% 
  full_join(pos_median_zar) %>% 
  #FIXME two decimal places for pos_zar
  mutate(pos_zar = zar - median_zar) -> rosters_by_position

team <- rosters_by_position %>% 
  filter(team == "Plouffe There It Is!")

positions <- c("C","1B","2B","3B","SS","LF","CF","RF","Util")

result <- tibble(
  position = positions,
  player_id = NA
)

batters <- team %>%
  filter(type == "batter") %>% 
  arrange(pos_zar %>% desc(), zar %>% desc() ) %>% 
  select(player_id, name_full, position, pos_zar, zar)

batter_ids <- batters$player_id %>% 
  as_factor() %>%
  levels()


for (i in 0:length(batter_ids)) {
  print(i+1)
}
```
